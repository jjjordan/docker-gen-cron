tests:
- containers:
  - name: a
    running: true
    env:
      CRON_0: ""
      CRON_1: "@daily touch /tmp/daily"
      CRON_2: "*/1 * * * * touch /tmp/minutely"
      CRON_3: "&runas(irc) */1 * * * * touch /tmp/minutely.irc"
      CRON_4: "VAR1=foo"
      CRON_5: 'VAR2 = "bar"'
      CRON_6: "*/1 * * * * export >output"
      CRON_START_0: "@daily"
      CRON_RESTART_0: "@hourly"
    cases:
    - index: 0
      crontab: ""
    - index: 1
      crontab_prefix: "@daily"
      crontab_suffix: "-- touch /tmp/daily"
      docker: ["exec", "-i", "a", "/bin/sh", "-c", "touch /tmp/daily"]
    - index: 2
      crontab_prefix: "*/1 * * * *"
      crontab_suffix: "-- touch /tmp/minutely"
      docker: ["exec", "-i", "a", "/bin/sh", "-c", "touch /tmp/minutely"]
    - index: 3
      crontab_prefix: "& */1 * * * *"
      crontab_suffix: "-- touch /tmp/minutely.irc"
      docker: ["exec", "-i", "-u", "irc", "a", "/bin/sh", "-c", "touch /tmp/minutely.irc"]
    - index: 4
      crontab: 'VAR1="foo"'
    - index: 5
      crontab: 'VAR2="bar"'
    - index: 6
      crontab_prefix: "*/1 * * * *"
      crontab_suffix: "-- export >output"
      docker: ["exec", "-i", "-e", "VAR1=foo", "-e", "VAR2=bar", "a", "/bin/sh", "-c", "export >output"]
    - index: 0
      start: true
      crontab: "@daily a start"
    - index: 0
      restart: true
      crontab: "@hourly a restart"
  - name: b
    running: true
    env:
      CRON_0: "!runas(irc)"
      CRON_1: "@daily touch /tmp/daily"
      CRON_2: "SHELL = /bin/ksh"
      CRON_3: "@hourly touch /tmp/hourly"
      CRON_4: "@reset 1d touch /tmp/daily"
    cases:
    - index: 0
      crontab: ""
    - index: 1
      crontab_prefix: "@daily"
      crontab_suffix: "-- touch /tmp/daily"
      docker: ["exec", "-i", "-u", "irc", "b", "/bin/sh", "-c", "touch /tmp/daily"]
    - index: 2
      crontab: ""
    - index: 3
      crontab_prefix: "@hourly"
      crontab_suffix: "-- touch /tmp/hourly"
      docker: ["exec", "-i", "-u", "irc", "b", "/bin/ksh", "-c", "touch /tmp/hourly"]
    - index: 4
      crontab_prefix: "@reset 1d"
      crontab_suffix: "-- touch /tmp/daily"
      docker: ["exec", "-i", "b", "/bin/sh", "-c", "touch /tmp/daily"]
  - name: c
    running: false
    env:
      CRON_0: "@hourly touch /tmp/foo"
      CRON_START_0: "@daily"
      CRON_RESTART_0: "@hourly"
    cases:
    - index: 0
      crontab: ""
    - index: 0
      start: true
      crontab: "@daily c start"
    - index: 0
      restart: true
      crontab: "@hourly c restart"
  - name: d
    running: true
    env:
      CRON_0: "!jitter(5),nice(50),nolog"
      CRON_1: "&mailfrom,nice(3) 1 1 * * * touch /tmp/something"
    cases:
    - index: 0
      crontab: "!jitter(5),nolog"
    - index: 1
      crontab_prefix: "&mailfrom 1 1 * * *"
      crontab_suffix: "-- touch /tmp/something"
- containers:
  - name: shortcuts_test
    running: true
    env:
      CRON_0: "%hourly 5 touch /tmp/foo"
      CRON_1: "%daily 5 5 touch /tmp/foo"
      CRON_2: "%monthly 5 5 5 touch /tmp/foo"
      CRON_3: "@hourly,runas(irc) 5 touch /tmp/foo"
      CRON_4: "@daily,runas(irc) 5 5 touch /tmp/foo"
      CRON_5: "@monthly,runas(irc) 5 5 5 touch /tmp/foo"
    cases:
    - index: 0
      crontab_prefix: "%hourly 5"
      crontab_suffix: "-- touch /tmp/foo"
    - index: 1
      crontab_prefix: "%daily 5 5"
      crontab_suffix: "-- touch /tmp/foo"
    - index: 2
      crontab_prefix: "%monthly 5 5 5"
      crontab_suffix: "-- touch /tmp/foo"
    - index: 3
      crontab_prefix: "@hourly,n(0) 5"
      crontab_suffix: "-- touch /tmp/foo"
      docker: ["exec", "-i", "-u", "irc", "shortcuts_test", "/bin/sh", "-c", "touch /tmp/foo"]
    - index: 4
      crontab_prefix: "@daily,n(0) 5 5"
      crontab_suffix: "-- touch /tmp/foo"
    - index: 5
      crontab_prefix: "@monthly,n(0) 5 5 5"
      crontab_suffix: "-- touch /tmp/foo"
- containers:
  - name: newlines_test
    running: true
    env:
      CRON_0: "abc=def\nghi"
      CRON_1: "!lavg(1\n2)"
      CRON_2: "* *\n* * * touch hello.txt"
      CRON_3: "\n@daily backup.sh"
      CRON_4: "* * * * * echo hello\nworld"
    cases:
    - index: 0
      crontab: 'abc="def"'
    - index: 1
      crontab: "!lavg"
    - index: 2
      crontab: ""
    - index: 3
      crontab_prefix: "@daily"
      crontab_suffix: "-- backup.sh"
    - index: 4
      crontab_prefix: "* * * * *"
      crontab_suffix: "-- echo hello"
      docker: ["exec", "-i", "-e", "abc=def", "newlines_test", "/bin/sh", "-c", "echo hello\nworld"]
